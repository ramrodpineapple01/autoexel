<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WCCSA Community Directory Management</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/print.css') }}" media="print">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <h1>WCCSA Community Directory Management</h1>
        </header>

        <nav class="tabs">
            <button class="tab-button active" data-tab="directory">Directory</button>
            <button class="tab-button" data-tab="bod">Board of Directors</button>
            <button class="tab-button" data-tab="committees">Committees</button>
            <button class="tab-button" data-tab="lot-owners">Lot Owners</button>
            <button class="tab-button" data-tab="lot-map">Lot Map</button>
        </nav>

        <!-- Directory Tab -->
        <div id="directory-tab" class="tab-content active">
            <div class="section-header">
                <h2>Directory</h2>
                <div class="actions">
                    <button class="btn btn-primary" id="add-directory-btn">Add Entry</button>
                    <button class="btn btn-secondary" id="bulk-import-directory-btn">Bulk Import</button>
                    <button class="btn btn-secondary" id="download-template-directory-btn">Download Template</button>
                    <button class="btn btn-secondary" onclick="window.print()">Print</button>
                </div>
            </div>
            
            <div class="search-box">
                <input type="text" id="directory-search" placeholder="Search by owner, phone, address, city, zip, or email...">
            </div>

            <div class="table-container">
                <table id="directory-table" class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Owner</th>
                            <th>Phone</th>
                            <th>Address</th>
                            <th>City</th>
                            <th>State</th>
                            <th>Zip</th>
                            <th>Email</th>
                            <th>Lot Number</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="directory-tbody">
                        <tr><td colspan="10" class="loading">Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Board of Directors Tab -->
        <div id="bod-tab" class="tab-content">
            <div class="section-header">
                <h2>Board of Directors</h2>
                <div class="actions">
                    <select id="bod-year-select">
                        <option value="">Select Year...</option>
                    </select>
                    <button class="btn btn-primary" id="add-bod-year-btn">Add New Year</button>
                    <button class="btn btn-secondary" onclick="window.print()">Print</button>
                </div>
            </div>

            <div id="bod-content">
                <div class="bod-cards" id="bod-cards">
                    <p class="info-message">Select a year or add a new year to manage the Board of Directors.</p>
                </div>
            </div>
        </div>

        <!-- Committees Tab -->
        <div id="committees-tab" class="tab-content">
            <div class="section-header">
                <h2>Committees</h2>
                <button class="btn btn-secondary" onclick="window.print()">Print</button>
            </div>

            <div id="committees-content">
                <div id="committees-list"></div>
            </div>
        </div>

        <!-- Lot Owners Tab -->
        <div id="lot-owners-tab" class="tab-content">
            <div class="section-header">
                <h2>Lot Owners</h2>
                <div class="actions">
                    <button class="btn btn-primary" id="sync-lot-owners-btn">Sync from Directory</button>
                    <button class="btn btn-secondary" id="bulk-import-lot-owners-btn">Bulk Import</button>
                    <button class="btn btn-secondary" id="download-template-lot-owners-btn">Download Template</button>
                    <button class="btn btn-secondary" onclick="window.print()">Print</button>
                </div>
            </div>

            <div class="table-container">
                <table id="lot-owners-table" class="data-table">
                    <thead>
                        <tr>
                            <th>Surname</th>
                            <th>First Name</th>
                            <th>Lot Numbers</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="lot-owners-tbody">
                        <tr><td colspan="4" class="loading">Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Lot Map Tab -->
        <div id="lot-map-tab" class="tab-content">
            <div class="section-header">
                <h2>Lot Map</h2>
                <div class="actions">
                    <button class="btn btn-secondary" id="toggle-map-mode-btn">Editor Mode</button>
                    <button class="btn btn-secondary" onclick="window.print()">Print</button>
                </div>
            </div>

            <div id="lot-map-content">
                <div class="map-controls">
                    <button class="btn btn-sm" id="zoom-in-btn">Zoom In</button>
                    <button class="btn btn-sm" id="zoom-out-btn">Zoom Out</button>
                    <button class="btn btn-sm" id="reset-zoom-btn">Reset Zoom</button>
                </div>
                <div class="map-container">
                    <canvas id="lot-map-canvas"></canvas>
                </div>
                <div id="lot-map-editor-panel" class="editor-panel" style="display: none;">
                    <h3>Edit Lot Region</h3>
                    <div class="form-group">
                        <label>Lot Number:</label>
                        <input type="text" id="edit-lot-number" readonly>
                    </div>
                    <div class="form-group">
                        <label>Owner Name:</label>
                        <input type="text" id="edit-owner-name">
                    </div>
                    <div class="form-group">
                        <label>Label Position X:</label>
                        <input type="number" id="edit-label-x">
                    </div>
                    <div class="form-group">
                        <label>Label Position Y:</label>
                        <input type="number" id="edit-label-y">
                    </div>
                    <button class="btn btn-primary" id="save-lot-region-btn">Save Region</button>
                    <button class="btn btn-secondary" id="cancel-edit-btn">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="directory-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modal-title">Add Directory Entry</h2>
            <form id="directory-form">
                <input type="hidden" id="directory-id">
                <div class="form-group">
                    <label for="owner">Owner:</label>
                    <input type="text" id="owner" required>
                </div>
                <div class="form-group">
                    <label for="phone">Phone:</label>
                    <input type="text" id="phone">
                </div>
                <div class="form-group">
                    <label for="address">Address:</label>
                    <input type="text" id="address">
                </div>
                <div class="form-group">
                    <label for="city">City:</label>
                    <input type="text" id="city">
                </div>
                <div class="form-group">
                    <label for="state">State:</label>
                    <input type="text" id="state" maxlength="2" placeholder="e.g., CA">
                </div>
                <div class="form-group">
                    <label for="zip">Zip:</label>
                    <input type="text" id="zip">
                </div>
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email">
                </div>
                <div class="form-group">
                    <label for="lot-number">Lot Number:</label>
                    <input type="text" id="lot-number" placeholder="e.g., 1,2,3">
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Save</button>
                    <button type="button" class="btn btn-secondary" id="cancel-directory-btn">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <div id="bulk-import-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Bulk Import</h2>
            <form id="bulk-import-form">
                <div class="form-group">
                    <label for="csv-file">Select CSV File:</label>
                    <input type="file" id="csv-file" accept=".csv" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Import</button>
                    <button type="button" class="btn btn-secondary" id="cancel-import-btn">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <div id="add-year-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Add New Year</h2>
            <form id="add-year-form">
                <div class="form-group">
                    <label for="new-year">Year:</label>
                    <input type="number" id="new-year" min="2000" max="2100" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Add</button>
                    <button type="button" class="btn btn-secondary" id="cancel-year-btn">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script src="{{ url_for('static', filename='js/directory.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bod.js') }}"></script>
    <script src="{{ url_for('static', filename='js/committees.js') }}"></script>
    <script src="{{ url_for('static', filename='js/lots.js') }}"></script>
    <script src="{{ url_for('static', filename='js/lotmap.js') }}"></script>
</body>
</html>

